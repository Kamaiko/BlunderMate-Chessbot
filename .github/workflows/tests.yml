name: Prolog Chess Tests

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]

jobs:
  test-suite:
    runs-on: ubuntu-latest
    container: swipl:latest  # Image Docker officielle SWI-Prolog (~30s vs 2-3min)

    steps:
    - uses: actions/checkout@v4

    - name: Verify SWI-Prolog installation
      run: swipl --version

    - name: Debug - Show directory structure
      run: |
        echo "Current directory: $(pwd)"
        echo "Files in current directory:"
        ls -la
        echo "Test directory contents:"
        ls -la tests/

    - name: Run Chess Tests
      run: swipl -s tests/tests.pl -g "run_tests, halt."

    - name: Run Foundation Tests
      run: swipl -s tests/tests.pl -g "run_foundation_tests, halt."

    - name: Run Game Rules Tests
      run: swipl -s tests/tests.pl -g "run_game_rules_tests, halt."

    - name: Run AI Algorithm Tests
      run: swipl -s tests/tests.pl -g "run_ai_algorithm_tests, halt."

    - name: Run AI Evaluation Tests
      run: swipl -s tests/tests.pl -g "run_ai_evaluation_tests, halt."

    - name: Run Tactical Tests
      run: swipl -s tests/tests.pl -g "run_tactical_tests, halt."

    - name: Run Robustness Tests
      run: swipl -s tests/tests.pl -g "run_robustness_tests, halt."

    - name: Run Integration Tests
      run: swipl -s tests/tests.pl -g "run_integration_tests, halt."

    - name: Test Game Launch
      run: |
        echo "Testing basic game file loading..."
        swipl -s src/interface.pl -g "write('Interface module loaded successfully'), halt."